## Usage

Find out how to initialise the Editor from Brizy's CDN infrastructure from the video below:

https://user-images.githubusercontent.com/10077249/206906576-cc654003-9b6d-4661-88dd-affb63ba538d.mp4

```shell
# Builder Container
<div id="editor" style="height: 85vh; width: 100vw"></div>

# Update button
<button id="update">Update</button>

# Story CDN version: <script src="https://cdn.brizylocal.com/story/2.1.4/index.js"></script>
# Popup CDN version: <script src="https://cdn.brizylocal.com/popup/2.1.4/index.js"></script>
# Pages CDN version: <script src="https://cdn.brizylocal.com/pages/2.1.4/index.js"></script>
<script src="https://cdn.brizylocal.com/pages/2.1.4/index.js"></script>

<script>
  # Story Config Example: https://github.com/EasyBrizy/Brizy-Local/blob/story/packages/demo/public/index.html
  # Popup Config Example: https://github.com/EasyBrizy/Brizy-Local/blob/popup/packages/demo/public/index.html
  # Pages Config Example: https://github.com/EasyBrizy/Brizy-Local/blob/pages/packages/demo/public/index.html
  const config = {...};
  const editor = document.querySelector("#editor");
  const update = document.querySelector("#update");

  const Builder = window.Builder;
  let builderAPI;

  # This demo token will limit the output to a pre determined HTML and let you test the Editor before deciding on a commercial license.
  # To unlock all functionality and reseller the editor to your clients, you'll need an unique token generated by us.
  # Contact us: https://www.brizy.io/brizylocal#lets-talk
  const token = "demo";

  Builder.init(token, config, (api) => {
    builderAPI = api;
  });

  update.addEventListener("click", () => {
    builderAPI.save();
  });
</script>

```

## Config

```ts
type config = {
  container: HTMLElement;
  pageData: Record<string, unknown>;
  projectData: Record<string, unknown>;

  // Page: Static Page view
  // Popup: Static Popup view with conditions(open on exit, open after x minutes)
  // Story: Static story carosuel view
  mode: "page" | "popup" | "story";

  // Monolith: Full HTML with DOCTYPE, head and body
  // Partial: the root is a div element with all page compiled,
  /// use this case when you need to create a fully customizable preview HTML
  htmlOutputType: "monolith" | "partial";

  // Menu
  menu?: Array<Menu>;

  // Integration
  integration?: {
    /// Form
    form?: {
      action?: string;
      recaptcha?: {
        siteKey: string;
      };
      fields?: {
        label?: string;
        handler: (res: Response<Array<FormFieldsOption>>, rej: Response<string>) => void;
      };
    };
  };

  // DynamicContent
  dynamicContent?: {
    makePlaceholder?: MakePlaceholder;
    explodePlaceholder?: ExplodePlaceholder;
    groups?: {
      [DCTypes.image]: Array<ConfigDCItem> | DCItemHandler;
      [DCTypes.link]: Array<ConfigDCItem> | DCItemHandler;
      [DCTypes.richText]: Array<ConfigDCItem> | DCItemHandler;
    };
  };

  pagePreview: string;

  // UI
  ui: {
    popupSettings?: {
      displayCondition?: boolean;
      deletePopup?: boolean;
      embedded?: boolean;
      horizontalAlign?: boolean;
      verticalAlign?: boolean;
      backgroundPreviewUrl?: string;
      scrollPageBehind?: boolean;
      clickOutsideToClose?: boolean;
    };

    theme?: Theme;

    leftSidebar?: {
      topTabsOrder?: Array<"addElements", "reorderBlock", "globalStyle", "deviceMode", "more">;
      bottomTabsOrder?: Array<"addElements", "reorderBlock", "globalStyle", "deviceMode", "more">;

      more?: {
        options?: Array<{
          type: "link";
          label: string;
          link: string;
          linkTarget?: "_blank" | "_self" | "_parent" | "_top";
        }>;
      };

      // AddElements
      moduleGroups?: Array<{
        label: string;
        moduleNames: Array<BaseElementTypes | StoryElementTypes>;
      }>;
    };
  };

  // API
  api?: {
    /// Media
    media?: {
      mediaResizeUrl?: string;

      addMedia?: {
        handler: (resolve: Response<AddMediaData>, reject: Response<string>, extra: AddMediaExtra) => void;
      };
    };

    // File
    customFile?: {
      fileUrl?: string;

      addFile?: {
        handler: (res: Response<AddFileData>, rej: Response<string>, extra: AddFileExtra) => void;
      };
    };

    // Default Blocks | Kits | Popups | Stories
    defaultKits?: DefaultTemplate<Array<Kits>, Block>; // More information about the type types/types.ts
    defaultPopups?: DefaultTemplate<Popups, Popup>; // More information about the type types/types.ts
    defaultLayouts?: DefaultTemplate<Layouts, Layout>; // More information about the type types/types.ts

    // Used only in mode: story
    defaultStories?: DefaultTemplate<Stories, Story>; // More information about the type types/types.ts

    // Screebnshots
    screenshots?: {
      screenshotUrl?: string;
      create?: (
        res: Response<{ id: string }>,
        rej: Response<string>,
        extra: ScreenshotData
      ) => void;
      update?: (
        res: Response<{ id: string }>,
        rej: Response<string>,
        extra: ScreenshotData & { id: string }
      ) => void;
    };
  };

  onSave?: (data: Output) => void;
  onLoad?: VoidFunction;
};

interface Output {
  pageData: Record<string, unknown>;
  projectData: Record<string, unknown>;

  html?: {
    root: string;
    styles?: Array<string>;
    scripts?: Array<string>;
  };

  // Only in popup mode
  popupSettings?: {
    verticalAlign: "top" | "bottom" | "center";
    horizontalAlign: "left" | "right" | "center";
  };

  // Error when html will be undefined
  error?: string;
}

// Menu
interface Menu {
  id: string;
  name: string;
  items: Array<MenuItem>;
}

// MenuItem
export interface MenuItem {
  type: "MenuItem";
  value: {
    id: string;
    title: string;
    url: string;
    target?: string;
    classes?: Array<string>;

    // Dropdown
    items?: Array<MenuItem>;
  };
}

// FormFieldsOption
export interface FormFieldsOption {
  title: string;
  value: string;
}

// DynamicContent
export enum DCTypes {
  image = "image",
  link = "link",
  richText = "richText",
}
interface BaseDCItem {
  label: string;
  placeholder: string;
}
export interface ConfigDCItem extends BaseDCItem {
  optgroup?: ConfigDCItem[];
}
interface DCItemHandler {
  handler: (
    res: Response<BaseDCItem>,
    rej: Response<string>,
    extra?: { keyCode: string }
  ) => void;
}
interface DCPlaceholderObj {
  name: string;
  attr?: Record<string, unknown>;
}

type MakePlaceholder = (placeholderObj: DCPlaceholderObj) => string | undefined;

type ExplodePlaceholder = (placeholder: string) => DCPlaceholderObj | undefined;

// Media
export interface AddMediaData {
  fileName: string; // fileName need contain .ext
}
export interface AddMediaExtra {
  acceptedExtensions: Array<string>; // [.jpg, .png, .svg, .etc]
}

// File
export interface AddFileData {
  filename: string;
}

export interface AddFileExtra {
  acceptedExtensions: Array<string>; // [.jpg, .png, .svg, .zip .txs .etc]
}

// ElementTypes
/// Base Elements used in Page | Popup, these elements doesn't work in Story
export enum BaseElementTypes {
  Text = "Text",
  Image = "Image",
  Button = "Button",
  Icon = "Icon",
  Spacer = "Spacer",
  Map = "Map",
  Form2 = "Form2",
  Line = "Line",
  Menu = "Menu",
  ImageGallery = "ImageGallery",
  Video = "Video",
  Audio = "Audio",
  VideoPlaylist = "VideoPlaylist",
  IconText = "IconText",
  Lottie = "Lottie",
  Embed = "Embed",
  StarRating = "StarRating",
  Alert = "Alert",
  Counter = "Counter",
  Countdown2 = "Countdown2",
  ProgressBar = "ProgressBar",
  Calendly = "Calendly",
  Carousel = "Carousel",
  Tabs = "Tabs",
  Accordion = "Accordion",
  Switcher = "Switcher",
  Table = "Table",
  Timeline = "Timeline",
  Facebook = "Facebook",
  Twitter = "Twitter",
  FacebookComments = "FacebookComments",
  Columns = "Columns",
  Row = "Row"
}

/// Story Elements used only in Story mode, these elements doesn't work in Page, Popup
export enum StoryElementTypes {
  StoryButton = "StoryButton",
  StoryIcon = "StoryIcon",
  StoryEmbed = "StoryEmbed",
  StoryText = "StoryText",
  StoryMap = "StoryMap",
  StoryProgressBar = "StoryProgressBar",
  StoryLine = "StoryLine",
  StoryCountdown2 = "StoryCountdown2",
  StoryCounter = "StoryCounter",
  StoryShape = "StoryShape",
  StoryForm2 = "StoryForm2",
  StoryStarRating = "StoryStarRating",
  StoryLottie = "StoryLottie",
  StoryImage = "StoryImage",
  StoryVideo = "StoryVideo"
}

// Theme
export interface Theme {
  colors: {
    "--primary-dark"?: string;
    "--secondary-dark"?: string;
    "--tertiary-dark"?: string;
    "--primary-white"?: string;
    "--secondary-white"?: string;
    "--tertiary-white"?: string;
    "--primary-gray"?: string;
    "--secondary-gray"?: string;
    "--tertiary-gray"?: string;
    "--active-color"?: string;
    "--light-gray"?: string;
  };
}

// Defaults Blocks
export interface DefaultTemplate<T1, T2> {
  label?: string;
  getMeta: (res: Response<T1>, rej: Response<string>) => void;
  getData: (
    res: Response<Promise<T2>>,
    rej: Response<string>,
    blockId: string
  ) => void;
}

// Screenshots
export interface ScreenshotData {
  base64: string;
  blockType: "normal" | "global" | "saved" | "layout";
}
```

Config can be passed as an object when you initialize the editor from the script.

| Name           | Type                     | Description                                                    |
|:---------------|:-------------------------|:---------------------------------------------------------------|
| container      | HTMLElement              | Brizy Plugin will load into HTML element.                      |
| mode           | "page", "popup", "story" | Default "page"                                                 |
| htmlOutputType | "monolith" or "partial"  | Default "monolith"                                             |
| pageData       | object                   | Loads the JSON page specified in the pageData parameter.       |
| projectData    | object                   | Loads the JSON project specified in the projectData parameter. |
| menu           | array                    | Load the array of menu                                         |

### Integration parameters

| Name                               | Type       | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|:-----------------------------------|:-----------|:-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| integration.form.action            | string     | Replace the URL with your own. This is the link where we send the information from the contact form element when the end user submits the form.                                                                                                                                                                                                                                                                                                                                                  |
| integration.form.recaptcha.siteKey | string     | ReCaptcha Site Key                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| integration.form.fields.label      | string     | Defines the text displayed in the editor UI.                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| integration.form.fields.handler    | function   | Is a function with a Promise-like signature. This function lets you use your own logic to retrieve the desired value. Once the value is available, you must call the resolve(value) function to pass it to the editor. In case you want to cancel the operation, call the reject() function. A resolve or reject call is mandatory. If you miss this step, the editor will remain in waiting mode. Error management on the host application must call the reject function to unblock the editor. |

### DynamicContent parameters

Dynamic content can be configured in 2 ways

1. Send an array of placeholder in config via:

#### DynamicContent Array of choices

| Name                                             | Type      | Description                                                                                                                                                                                                                                                                                   |
|:-------------------------------------------------|:----------|:----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| dynamicContent.makePlaceholder(not completed)    | function  | Is a function to create the placeholder from object `{ name: "placeholder_name", attr: { attr1: 1, attr2: 2 } }` to string `{{ placeholder_name attr1=1 attr2=2 }}`, used for additional [context](https://github.com/EasyBrizy/builder/assets/18303258/cfe8dc0d-80ab-435d-a625-51f088e9e290) |
| dynamicContent.explodePlaceholder(not completed) | function  | Is a function to create the placeholder from string `{{ placeholder_name attr1=1 attr2=2 }}` to object `{ name: 'placeholder_name', attr: { attr1: 1, attr2: 2 } }`, used for additional [context](https://github.com/EasyBrizy/builder/assets/18303258/cfe8dc0d-80ab-435d-a625-51f088e9e290) |
| dynamicContent.groups[DCTypes.image]             | array     | Takes array of ConfigDCItem for all Element what persis ImageUpload                                                                                                                                                                                                                           |
| dynamicContent.groups[DCTypes.link]              | array     | Takes array of ConfigDCItem for all Element what persis Link                                                                                                                                                                                                                                  |
| dynamicContent.groups[DCTypes.richText]          | array     | Takes array of ConfigDCItem for all Element what persis Content html                                                                                                                                                                                                                          |

2. Send a handler function that sends the placeholder over the response function
#### DynamicContent Option parameters

| Name                                              | Type       | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|:--------------------------------------------------|:-----------|:---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| dynamicContent.makePlaceholder(not completed)     | function   | Is a function to create the placeholder from object `{ name: "placeholder_name", attr: { attr1: 1, attr2: 2 } }` to string `{{ placeholder_name attr1=1 attr2=2 }}`, used for additional [context](https://github.com/EasyBrizy/builder/assets/18303258/cfe8dc0d-80ab-435d-a625-51f088e9e290)                                                                                                                                                                                                                                                                                                      |
| dynamicContent.explodePlaceholder(not completed)  | function   | Is a function to create the placeholder from string `{{ placeholder_name attr1=1 attr2=2 }}` to object `{ name: 'placeholder_name', attr: { attr1: 1, attr2: 2 } }`, used for additional [context](https://github.com/EasyBrizy/builder/assets/18303258/cfe8dc0d-80ab-435d-a625-51f088e9e290)                                                                                                                                                                                                                                                                                                      |
| dynamicContent.groups[DCTypes.image].handler      | function   | Is a function with a Promise-like signature. This function lets you use your own logic to retrieve the desired value. Once the value is available, you must call the resolve(value) function to pass it to the editor ( example of resolve: `resolve({ label:"My_Placeholder", placeholder:"{{ my_placeholder }}" })` ). In case you want to cancel the operation, call the reject() function. A resolve or reject call is mandatory. If you miss this step, the editor will remain in waiting mode. Error management on the host application must call the reject function to unblock the editor. |
| dynamicContent.groups[DCTypes.link].handler       | function   | Is a function with a Promise-like signature. This function lets you use your own logic to retrieve the desired value. Once the value is available, you must call the resolve(value) function to pass it to the editor ( example of resolve: `resolve({ label:"My_Placeholder", placeholder:"{{ my_placeholder }}" })` ). In case you want to cancel the operation, call the reject() function. A resolve or reject call is mandatory. If you miss this step, the editor will remain in waiting mode. Error management on the host application must call the reject function to unblock the editor. |
| dynamicContent.groups[DCTypes.richText].handler   | function   | Is a function with a Promise-like signature. This function lets you use your own logic to retrieve the desired value. Once the value is available, you must call the resolve(value) function to pass it to the editor ( example of resolve: `resolve({ label:"My_Placeholder", placeholder:"{{ my_placeholder }}" })` ). In case you want to cancel the operation, call the reject() function. A resolve or reject call is mandatory. If you miss this step, the editor will remain in waiting mode. Error management on the host application must call the reject function to unblock the editor. |

### UI parameters

| Name                                  | Type    | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|:--------------------------------------|:--------|:-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| ui.popupSettings.displayCondition     | boolean | Takes true or false values and lets you turn on or off the global [display conditions](https://user-images.githubusercontent.com/10077249/206892163-024f4fcd-d127-4c28-8a60-ea21e3982b3c.png) option together with the [display conditions popup](https://user-images.githubusercontent.com/10077249/206892176-23ed85ee-4f66-4c83-8ebb-a64117daa124.png).                                                                                                                                                                |
| ui.popupSettings.deletePopup          | boolean | Takes true or false values and lets you turn on or off the [delete popup option](https://user-images.githubusercontent.com/10077249/206904265-7e79f65f-0288-4473-be14-afb5dcea6fbb.png). Turn off the delete option when you want to load your json templates in the pageDate parameter. Turning off the delete option will also remove the posibility to [access the premade Brizy templates](https://user-images.githubusercontent.com/10077249/206904279-f55a472a-5508-4594-b40f-6c9d20a90bd9.png) inside the editor. |
| ui.popupSettings.embedded             | boolean | Takes true of false values and lets you turn on or off [Vertical align, Horizontal align, Scroll Page Behind and Close Button](https://user-images.githubusercontent.com/18303258/212686108-a43883df-574f-4b30-b795-5d48e93b3d08.png).                                                                                                                                                                                                                                                                                   |
| ui.popupSettings.verticalAlign        | boolean | Takes true or false values and lets you turn on or off the [Vertical align](https://user-images.githubusercontent.com/5760683/216273483-955e0a09-5acc-4124-bc94-0a05f2bbbb58.png).                                                                                                                                                                                                                                                                                                                                       |
| ui.popupSettings.horizontalAlign      | boolean | Takes true or false values and lets you turn on or off the [Horizontal align](https://user-images.githubusercontent.com/5760683/216273441-a50bf80e-5894-4e5f-b764-20ee1552b0f6.png).                                                                                                                                                                                                                                                                                                                                     |
| ui.popupSettings.scrollPageBehind     | boolean | Takes true or false values and lets you turn on or off the [Scroll Page Behind](https://user-images.githubusercontent.com/18303258/227510068-694a4dc7-d168-4416-9058-9fb3d0801669.png).                                                                                                                                                                                                                                                                                                                                  |
| ui.popupSettings.clickOutsideToClose  | boolean | Takes true or false values and lets you turn on or off the [Click Outside To Close](https://user-images.githubusercontent.com/18303258/227510345-89b4bfb2-56ae-49a5-aab1-1c929309dadf.png).                                                                                                                                                                                                                                                                                                                              |
| ui.popupSettings.backgroundPreviewUrl | string  | Lets you control the preview background url                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| ui.leftSidebar.topTabsOrder           | Array   | Lets you control the order and turning on or off the [icons in the left sidebar at the top](https://user-images.githubusercontent.com/10077249/206904478-d11e2fb3-addb-48c1-8dce-123868e8d8ac.png). Can take the values: "**addElements**", "**reorderBlock**", "**globalStyle**", "**deviceMode**" and "**more**". Leave "**blank**" if you want to disable one of the icons.                                                                                                                                           |
| ui.leftSidebar.bottomTabsOrder        | Array   | Lets you control the order and turning on or off the [icons in the left sidebar at the bottom](https://user-images.githubusercontent.com/10077249/206904746-f23a8b8d-ed58-4c20-b036-d204efc94437.png). Can take the values: "**addElements**", "**reorderBlock**", "**globalStyle**", "**deviceMode**" and "**more**". Leave "**blank**" if you want to disable one of the icons.                                                                                                                                        |
| ui.leftSidebar.more.options           | Array   | Lets you add more links in the [More dropdown](https://user-images.githubusercontent.com/10077249/206904832-5af03a48-991a-4c90-aead-2d7dea82c9d5.png) in the left sidebar.                                                                                                                                                                                                                                                                                                                                               |
| ui.leftSidebar.moduleGroups           | Array   | Lets you control the elements and turing on or off the [icons in the addElements](https://user-images.githubusercontent.com/18303258/230393691-1f0e5198-43e7-43ee-ab06-8d8d0f5f9c03.png) in the left sidebar. The default arrangement you can see [here](https://github.com/EasyBrizy/Brizy-Local-Editor/blob/master/packages/core/docs/self-hosted.MD#default-modulesgroup)                                                                                                                                             |

### API parameters

| Name                           | Type     | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|:-------------------------------|:---------|:-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| api.media.mediaResizeUrl       | string   | This is the URL for the image resizer service. There are two image resizer service options: hosted by Brizy and self hosted. If you choose to use the image resizer service hosted by Brizy, you don't have to change the media.brizylocal.com URL. For the self hosted version you need to replace the media.brizylocal.com with the URL of your image resizer service. Setup your own image resizer service like [this](https://github.com/EasyBrizy/Brizy-Local-Image-Resizer#image-resizer)                                                                                                                              |
| api.media.addMedia.handler     | function | Is a function with a Promise-like signature. This function lets you use your own logic to retrieve the desired value. Once the value is available, you must call the resolve(value) function to pass it to the editor. In case you want to cancel the operation, call the reject() function. A resolve or reject call is mandatory. If you miss this step, the editor will remain in waiting mode. Error management on the host application must call the reject function to unblock the editor.                                                                                                                             |
| api.customFile.fileUrl         | string   | This is the URL for your resources the final URL will be `api.customFile.fileUrl/${fileName}`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| api.customFile.addFile.handler | function | Is a function with a Promise-like signature. This function lets you use your own logic to retrieve the desired value. Once the value is available, you must call the resolve(value) function to pass it to the editor. In case you want to cancel the operation, call the reject() function. A resolve or reject call is mandatory. If you miss this step, the editor will remain in waiting mode. Error management on the host application must call the reject function to unblock the editor.                                                                                                                             |
| api.defaultKits.label          | string   | Defines the text displayed in the editor UI.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| api.defaultKits.getMeta        | function | Is a function with a Promise-like signature. This function lets you use your own logic to retrieve the desired value. Once the value is available, you must call the resolve(value) function to pass it to the editor ( example of resolve: `resolve([ Array of kits with blocks ])`). In case you want to cancel the operation, call the reject() function. A resolve or reject call is mandatory. If you miss this step, the editor will remain in waiting mode. Error management on the host application must call the reject function to unblock the editor.                                                             |
| api.defaultKits.getData        | function | Is a function with a Promise-like signature. This function lets you use your own logic to retrieve the desired value. Once the value is available, you must call the resolve(value) function to pass it to the editor ( example of resolve: `resolve(block.json)`). In case you want to cancel the operation, call the reject() function. A resolve or reject call is mandatory. If you miss this step, the editor will remain in waiting mode. Error management on the host application must call the reject function to unblock the editor.                                                                                |
| api.defaultPopups.label        | string   | Defines the text displayed in the editor UI.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| api.defaultPopups.getMeta      | function | Is a function with a Promise-like signature. This function lets you use your own logic to retrieve the desired value. Once the value is available, you must call the resolve(value) function to pass it to the editor ( example of resolve: `resolve({ blocks: [ Array of blocks with screenshots and id] })`). In case you want to cancel the operation, call the reject() function. A resolve or reject call is mandatory. If you miss this step, the editor will remain in waiting mode. Error management on the host application must call the reject function to unblock the editor.                                    |
| api.defaultPopups.getData      | function | Is a function with a Promise-like signature. This function lets you use your own logic to retrieve the desired value. Once the value is available, you must call the resolve(value) function to pass it to the editor ( example of resolve: `resolve(popup.json)`). In case you want to cancel the operation, call the reject() function. A resolve or reject call is mandatory. If you miss this step, the editor will remain in waiting mode. Error management on the host application must call the reject function to unblock the editor.                                                                                |
| api.defaultLayouts.label       | string   | Defines the text displayed in the editor UI.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| api.defaultLayouts.getMeta     | function | Is a function with a Promise-like signature. This function lets you use your own logic to retrieve the desired value. Once the value is available, you must call the resolve(value) function to pass it to the editor ( example of resolve: `resolve({ templates: [ Array of layouts with pages and every page must have screenshots and id] })`). In case you want to cancel the operation, call the reject() function. A resolve or reject call is mandatory. If you miss this step, the editor will remain in waiting mode. Error management on the host application must call the reject function to unblock the editor. |
| api.defaultLayouts.getData     | function | Is a function with a Promise-like signature. This function lets you use your own logic to retrieve the desired value. Once the value is available, you must call the resolve(value) function to pass it to the editor ( example of resolve: `resolve([ page.json ])`). In case you want to cancel the operation, call the reject() function. A resolve or reject call is mandatory. If you miss this step, the editor will remain in waiting mode. Error management on the host application must call the reject function to unblock the editor.                                                                             |
| api.defaultStories.label       | string   | Defines the text displayed in the editor UI.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| api.defaultStories.getMeta     | function | Is a function with a Promise-like signature. This function lets you use your own logic to retrieve the desired value. Once the value is available, you must call the resolve(value) function to pass it to the editor ( example of resolve: `resolve({ stories: [ Array of stories, every story must have screenshots and id] })`). In case you want to cancel the operation, call the reject() function. A resolve or reject call is mandatory. If you miss this step, the editor will remain in waiting mode. Error management on the host application must call the reject function to unblock the editor.                |
| api.defaultStories.getData     | function | Is a function with a Promise-like signature. This function lets you use your own logic to retrieve the desired value. Once the value is available, you must call the resolve(value) function to pass it to the editor ( example of resolve: `resolve([ story.json ])`). In case you want to cancel the operation, call the reject() function. A resolve or reject call is mandatory. If you miss this step, the editor will remain in waiting mode. Error management on the host application must call the reject function to unblock the editor.                                                                            |
| api.screenshots.screenshotUrl  | string   | This is the URL for the Screenshot                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| api.screenshots.create         | function | Is a function with a Promise-like signature. This function lets you use your own logic to retrieve the desired value. Once the value is available, you must call the resolve(value) function to pass it to the editor ( example of resolve: `resolve({ id: screenshot id })`). In case you want to cancel the operation, call the reject() function.                                                                                                                                                                                                                                                                         |
| api.screenshots.update         | function | Is a function with a Promise-like signature. This function lets you use your own logic to retrieve the desired value. Once the value is available, you must call the resolve(value) function to pass it to the editor ( example of resolve: `resolve({ id: screenshot id })`). In case you want to cancel the operation, call the reject() function.                                                                                                                                                                                                                                                                         |

#### Example Media Handler

```ts
const config = {
  api: {
    media: {
      handler(resolve, reject, extra) {
        // extra: { acceptedExtensions: Array<string> }
        resolve({
          fileName: "picture.png",
        });
      },
    },
  },
};
```

#### Example Media Handler with Brizy Local Image Resizer & AWS S3

```ts
// In HTML
// <script src="https://sdk.amazonaws.com/js/aws-sdk-2.1.24.min.js"></script>

const bucketName = "AWS_BUCKET_NAME";
const bucketRegion = "AWS_REGION";
const identityPoolId = "AWS_IDENTITY_POOL_ID";
const AWS = window.AWS;

// More details about AWS you can see here https://docs.aws.amazon.com/sdk-for-javascript/v3/developer-guide/welcome.html
AWS.config.update({
  region: bucketRegion,
  credentials: new AWS.CognitoIdentityCredentials({
    IdentityPoolId: identityPoolId,
  }),
});
const s3 = new AWS.S3({
  params: {
    Bucket: bucketName,
  },
});

const config = {
  api: {
    media: {
      // You need to start a Brizy Local Image Resize
      /// for more information on how you can do that see here https://github.com/EasyBrizy/Brizy-Local-Image-Resizer#readme
      /// ORIGIN_MEDIA_URL=https://${AWS_BUKET_NAME}/media
      mediaResizeUrl: "http://localhost:7788/media", // HOST [Brizy Local Image Resizer]
      handler(resolve, reject, extra) {
        const input = document.createElement("input");
        input.type = "file";
        input.accept = "image/*";

        input.addEventListener("change", function (e) {
          const { files } = e.target;

          if (files && files.length) {
            const file = files[0];
            const fileName = file.name;
            const filePath = `media/${fileName}`;
            const s3Config = {
              Key: filePath,
              Body: file,
            };

            // Upload to S3
            s3.upload(s3Config, (err) => {
              if (err) {
                reject(`Wrong Upload to S3 ${err.message}`);
              } else {
                resolve({ fileName });
              }
            });
          }
        });

        // Open Upload Window
        input.click();
      },
    },
  },
};
```

#### Default ModulesGroup
```ts
// Popup
const defaultConfigModulesGroupForPopup = {
  ui: {
    leftSidebar: {
      moduleGroups: [
        {
          label: "grid",
          moduleNames: ["Columns", "Row"],
        },
        {
          label: "essentials",
          moduleNames: [
            "Text",
            "Image",
            "Button",
            "Icon",
            "Spacer",
            "Map",
            "Form2",
            "Line",
          ],
        },
        {
          label: "media",
          moduleNames: [
            "ImageGallery",
            "Video",
            "Audio",
            "VideoPlaylist",
          ],
        },
        {
          label: "content",
          moduleNames: [
            "IconText",
            "Embed",
            "StarRating",
            "Alert",
            "Counter",
            "Countdown2",
            "ProgressBar",
            "Calendly",
            "Carousel",
            "Tabs",
            "Accordion",
            "Switcher",
            "Table",
            "Timeline",
          ],
        },
        {
          label: "social",
          moduleNames: ["Facebook", "Twitter", "FacebookComments"],
        },
      ],
    },
  },
};

// Story
const defaultConfigModulesGroupForStory = {
  ui: {
    leftSidebar: {
      moduleGroups: [
        {
          label: "essentials",
          moduleNames: [
            "StoryButton",
            "StoryIcon",
            "StoryEmbed",
            "StoryText",
            "StoryMap",
            "StoryProgressBar",
            "StoryLine",
            "StoryCountdown2",
            "StoryCounter",
            "StoryShape",
            "StoryForm2",
            "StoryStarRating",
            "StoryLottie",
          ],
        },
        {
          label: "media",
          moduleNames: ["StoryImage", "StoryVideo"],
        },
      ],
    },
  },
};

// Page
const defaultConfigModulesGroupForPages = {
  ui: {
    leftSidebar: {
      moduleGroups: [
        {
          label: "grid",
          moduleNames: ["Columns", "Row"],
        },
        {
          label: "essentials",
          moduleNames: ["Text", "Image", "Button", "Icon", "Spacer", "Map", "Form2", "Line", "Menu"],
        },
        {
          label: "media",
          moduleNames: ["ImageGallery", "Video", "Audio", "VideoPlaylist"],
        },
        {
          label: "content",
          moduleNames: [
            "IconText",
            "Embed",
            "StarRating",
            "Alert",
            "Counter",
            "Countdown2",
            "ProgressBar",
            "Calendly",
            "Carousel",
            "Tabs",
            "Accordion",
            "Switcher",
            "Table",
            "Timeline",
          ],
        },
        {
          label: "social",
          moduleNames: ["Facebook", "Twitter", "FacebookComments"],
        },
      ],
    },
  },
};
```

#### Example Dynamic Content(default)
Use below example if you don't want to use any customisations

```ts
const config = {
  dynamicContent: {
    makePlaceholder(placeholderObj) {
      return placeholderObj.name;
    },
    explodePlaceholder(placeholderStr) {
      return { name: placeholderStr }
    },
  }
};
```

#### Example API Default Kits
```ts
const config = {
  api: {
    defaultKits: {
      async getMeta(res, rej) {
        try {
          const meta = await fetch("https://example.com/blocks").then(
            (r) => r.json()
          );
          const block = {
            id: "block1",
            cat: [100],  // { same of value from kits.categories }
            title: "Block 1",
            thumbnailWidth: 100,
            thumbnailHeight: 100,
            thumbnailSrc: "https://example/com/block1/picture.png",
            type: 0, // { same of value from kits.type }
          }
          const kit1 = {
            id: "kit1",
            blocks: [block],
            name: "Kit name 1",
            types: [
              {
                "id": 0,
                "name": "light",
                "title": "Light",
                "icon": "nc-light"
              },
              {
                "id": 1,
                "name": "dark",
                "title": "Dark",
                "icon": "nc-dark"
              }
            ],
            categories: [
              {
                id: 100,
                slug: "blog",
                title: "Blog"
              },
            ]
          }
          const kit2 = {
            id: "kit2",
            blocks: [block],
            name: "Kit name 2",
            types: [
              {
                "id": 0,
                "name": "light",
                "title": "Light",
                "icon": "nc-light"
              },
              {
                "id": 1,
                "name": "dark",
                "title": "Dark",
                "icon": "nc-dark"
              }
            ],
          }

          res([kit1, kit2]);
        } catch (e) {
          rej("Failed to get json");
        }
      },
      async getData(res, rej, id) {
        try {
          const data = await fetch(`https://example.com/blocks/${id}.json`).then((r) =>
            r.json()
          );
          res(data);
        } catch (e) {
          rej("Failed to load resolves for selected DefaultKits");
        }
      },
    }
  }
}
```

#### Example API Default Popups
```ts
const config = {
  api: {
    defaultPopups: {
      async getMeta(res, rej) {
        try {
          const meta = await fetch("https://example.com/popups").then(
            (r) => r.json()
          );
          const popup = {
            id: "popup1",
            cat: [100],  // { same of value from data.categories }
            title: "Popup 1",
            thumbnailWidth: 100,
            thumbnailHeight: 100,
            thumbnailSrc: "https://example/com/popup1/picture.png"
          }
          const popup2 = {
            id: "popup2",
            cat: [200],  // { same of value from data.categories }
            title: "Popup 2",
            thumbnailWidth: 200,
            thumbnailHeight: 200,
            thumbnailSrc: "https://example/com/popup2/picture.png"
          }
          const data = {
            blocks: [popup, popup2],
            categories: [
              {
                id: 100,
                slug: "blog",
                title: "Blog"
              },
              {
                id: 200,
                slug: "portfolio",
                title: "Portfolio"
              },
            ]
          }

          res(data);
        } catch (e) {
          rej("Failed to get json");
        }
      },
      async getData(res, rej, id) {
        try {
          const data = await fetch(`https://example.com/popups/${id}.json`).then((r) =>
            r.json()
          );
          res(data);
        } catch (e) {
          rej("Failed to load resolves for selected DefaultPopups");
        }
      },
    }
  }
}
```

#### Example API Default Layouts
```ts
const config = {
  api: {
    defaultLayouts: {
      async getMeta(res, rej) {
        try {
          const meta = await fetch("https://example.com/layouts").then(
            (r) => r.json()
          );
          const page = {
            id: "page1",
            thumbnailWidth: 680,
            thumbnailHeight: 1282,
            thumbnailSrc: "https://example/com/page1/picture.png",
            title: "Homepage",
            keywords: "home, details, menu, reservation, food, lunch",
            cat: [ 100 ]
          }
          const layout = {
            name: "Template Name",
            color: "#FF7102",
            cat: [ 100 ],
            pages: [ page ],
            styles: [] // Global Style JSON
          }
          const data = {
            templates: [ layout ],
            categories: [
              {
                id: 100,
                title: "Business"
              },
              {
                id: 200,
                title: "Travel"
              },
            ]
          }

          res(data);
        } catch (e) {
          rej("Failed to get json");
        }
      },
      async getData(res, rej, id) {
        try {
          const data = await fetch(`https://example.com/layouts/${id}.json`).then((r) =>
            r.json()
          );
          res(data);
        } catch (e) {
          rej("Failed to load resolves for selected DefaultLayouts");
        }
      },
    }
  }
}
```

#### Example API Default Stories
```ts
const config = {
  api: {
    defaultStories: {
      async getMeta(res, rej) {
        try {
          const meta = await fetch("https://example.com/stories").then(
            (r) => r.json()
          );
          const page = {
            id: "story1",
            thumbnailWidth: 680,
            thumbnailHeight: 1282,
            thumbnailSrc: "https://example/com/story1/picture.png",
            title: "Homepage",
            keywords: "home, details, menu, reservation, food, lunch",
            cat: [ 100 ]
          }
          const story = {
            name: "Story Name",
            color: "#FF7102",
            cat: [ 100 ],
            pages: [ page ],
            styles: [] // Global Style JSON
          }
          const data = {
            stories: [ story ],
            categories: [
              {
                id: 100,
                title: "Business"
              },
              {
                id: 200,
                title: "Travel"
              },
            ]
          }

          res(data);
        } catch (e) {
          rej("Failed to get json");
        }
      },
      async getData(res, rej, id) {
        try {
          const data = await fetch(`https://example.com/story/${id}.json`).then((r) =>
            r.json()
          );
          res(data);
        } catch (e) {
          rej("Failed to load resolves for selected DefaultStories");
        }
      },
    }
  }
}
```

#### Example API Screenshots

```ts
export interface ScreenshotData {
  base64: string;
  blockType: "normal" | "global" | "saved" | "layout";
}

const config = {
  api: {
    screenshots: {
      screenshotUrl: "https://example.com/screenshots",
      async create(res, rej, data: ScreenshotData) {
        try {
          const screenshot = await fetch("https://example.com/api/screenshot", {
            method: "POST",
            body: JSON.stringify({ image: data.base64 })
          }).then((r) => r.json());

          res({ id: screenshot.id });
        } catch (e) {
          rej("Failed create the screenshot");
        }
      },
      async update(res, rej, data: ScreenshotData & { id: string }) {
        try {
          const data = await fetch(`https://example.com/api/screenshot/${data.id}`, {
            method: "PUT",
            body: JSON.stringify({ image: data.base64 })
          }).then((r) => r.json());

          res(data);
        } catch (e) {
          rej("Failed to update screenshot");
        }
      },
    }
  }
}
```
The url for the screenshot will be created like `${config.api.screenshots.screenshotUrl}/${id}?_thumbnailTime=${the screenshot time}`

### Events

These are the callbacks that are triggered when the buttons are clicked.

| Name   | Description                           | Returned values         |
|:-------|:--------------------------------------|:------------------------|
| onSave | Fired when the Save button is clicked | JSON and HTML documents |
| onLoad | Fired when the builder is loaded      | -                       |

#### onSave

| Name                               | Type        | Description                                                    |
|:-----------------------------------|:------------|:---------------------------------------------------------------|
| html                               | HTMLElement | HTML.                                                          |
| pageData                           | object      | Loads the JSON page specified in the pageData parameter.       |
| projectData                        | object      | Loads the JSON project specified in the projectData parameter. |
| popupSettings (only in popup mode) | object      | Loads horizontalAlign and VerticalAlign                        |

#### Popup Settings

| Name                          | Type                          | Description                                                                                                                                 |
|:------------------------------|:------------------------------|:--------------------------------------------------------------------------------------------------------------------------------------------|
| popupSettings.verticalAlign   | "center" or "top" or "bottom" | Default "center". [Vertical align](https://user-images.githubusercontent.com/5760683/216273483-955e0a09-5acc-4124-bc94-0a05f2bbbb58.png).   |
| popupSettings.horizontalAlign | "center" or "right" or "left" | Default "center". [Horizontal align](https://user-images.githubusercontent.com/5760683/216273441-a50bf80e-5894-4e5f-b764-20ee1552b0f6.png). |

See more details in TS [see below](https://github.com/EasyBrizy/Brizy-Local/blob/master/packages/core/src/types/types.ts)
